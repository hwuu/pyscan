{
  "version": "0.1",
  "created_date": "2025-10-19",
  "total_bugs": 105,
  "statistics": {
    "by_category": {
      "api_usage": 6,
      "type_safety": 7,
      "data_flow_issues": 15,
      "injection_flaws": 18,
      "input_validation": 10,
      "error_handling": 15,
      "concurrency": 17,
      "resource_management": 17
    },
    "by_severity": {
      "high": 58,
      "medium": 27,
      "low": 6,
      "critical": 14
    },
    "by_difficulty": {
      "easy": 30,
      "medium": 43,
      "hard": 4,
      "low": 6,
      "high": 22
    }
  },
  "bugs": [
    {
      "id": "API-DANGER-001",
      "category": "api_usage",
      "subcategory": "dangerous_api",
      "severity": "critical",
      "type": "UnsafeDeserialization",
      "file": "example1_pickle_yaml.py",
      "function": "load_user_session",
      "location": {
        "start_line": 23,
        "end_line": 23,
        "start_col": 4,
        "end_col": 43
      },
      "description": "pickle.loads() 反序列化不可信数据，可执行任意代码",
      "root_cause": "pickle 反序列化可触发 __reduce__ 方法执行任意代码",
      "cwe_id": "CWE-502",
      "difficulty": "low",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "08_api_usage\\dangerous_api\\positive\\example1_pickle_yaml.py"
    },
    {
      "id": "API-DANGER-002",
      "category": "api_usage",
      "subcategory": "dangerous_api",
      "severity": "high",
      "type": "UnsafeDeserialization",
      "file": "example1_pickle_yaml.py",
      "function": "load_config_yaml",
      "location": {
        "start_line": 48,
        "end_line": 48,
        "start_col": 4,
        "end_col": 61
      },
      "description": "yaml.load() 使用 FullLoader 可执行 Python 代码",
      "root_cause": "yaml.load 默认 Loader 不安全，应使用 safe_load",
      "cwe_id": "CWE-502",
      "difficulty": "low",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "08_api_usage\\dangerous_api\\positive\\example1_pickle_yaml.py"
    },
    {
      "id": "API-DANGER-003",
      "category": "api_usage",
      "subcategory": "dangerous_api",
      "severity": "critical",
      "type": "InsecureRandomness",
      "file": "example2_security_api.py",
      "function": "generate_session_token",
      "location": {
        "start_line": 26,
        "end_line": 26,
        "start_col": 4,
        "end_col": 66
      },
      "description": "使用 random 模块生成安全令牌，不是密码学安全的，可预测",
      "root_cause": "random 是伪随机数生成器，应使用 secrets 模块",
      "cwe_id": "CWE-330",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "08_api_usage\\dangerous_api\\positive\\example2_security_api.py"
    },
    {
      "id": "API-DANGER-004",
      "category": "api_usage",
      "subcategory": "dangerous_api",
      "severity": "high",
      "type": "AssertForValidation",
      "file": "example2_security_api.py",
      "function": "process_payment",
      "location": {
        "start_line": 71,
        "end_line": 72,
        "start_col": 4,
        "end_col": 54
      },
      "description": "使用 assert 进行数据验证，在优化模式（-O）下会被忽略",
      "root_cause": "assert 不应用于安全验证，应使用 if + raise",
      "cwe_id": "CWE-617",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "08_api_usage\\dangerous_api\\positive\\example2_security_api.py"
    },
    {
      "id": "API-DEP-001",
      "category": "api_usage",
      "subcategory": "deprecated_api",
      "severity": "low",
      "type": "DeprecatedAPI",
      "file": "example1_deprecated.py",
      "function": "get_linux_distribution",
      "location": {
        "start_line": 18,
        "end_line": 18,
        "start_col": 8,
        "end_col": 36
      },
      "description": "使用已废弃的 platform.dist()，Python 3.8+ 已移除",
      "root_cause": "应使用 distro 库或 platform.freedesktop_os_release()",
      "cwe_id": "CWE-477",
      "difficulty": "low",
      "related_bugs": [
        "BUG_0006"
      ],
      "detection_layer": "Layer 1",
      "relative_path": "08_api_usage\\deprecated_api\\positive\\example1_deprecated.py"
    },
    {
      "id": "API-DEP-002",
      "category": "api_usage",
      "subcategory": "deprecated_api",
      "severity": "low",
      "type": "DeprecatedAPI",
      "file": "example1_deprecated.py",
      "function": "load_module_dynamically",
      "location": {
        "start_line": 35,
        "end_line": 35,
        "start_col": 8,
        "end_col": 18
      },
      "description": "使用已废弃的 imp 模块，Python 3.4+ 废弃，3.12+ 移除",
      "root_cause": "应使用 importlib 替代",
      "cwe_id": "CWE-477",
      "difficulty": "low",
      "related_bugs": [
        "BUG_0006"
      ],
      "detection_layer": "Layer 1",
      "relative_path": "08_api_usage\\deprecated_api\\positive\\example1_deprecated.py"
    },
    {
      "id": "TYPE-API-001",
      "category": "type_safety",
      "subcategory": "api_contract",
      "severity": "high",
      "type": "MutableDefaultArgument",
      "file": "example1_api_contract.py",
      "function": "append_to_list",
      "location": {
        "start_line": 11,
        "end_line": 11,
        "start_col": 0,
        "end_col": 36
      },
      "description": "使用可变对象（列表）作为默认参数，所有调用共享同一个对象",
      "root_cause": "默认参数在函数定义时创建，多次调用会累积修改",
      "cwe_id": "CWE-1174",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "07_type_safety\\api_contract\\positive\\example1_api_contract.py"
    },
    {
      "id": "TYPE-API-002",
      "category": "type_safety",
      "subcategory": "api_contract",
      "severity": "high",
      "type": "InheritanceSignatureMismatch",
      "file": "example1_api_contract.py",
      "function": "SpecialHandler.handle",
      "location": {
        "start_line": 70,
        "end_line": 70,
        "start_col": 4,
        "end_col": 43
      },
      "description": "子类方法签名与父类不一致，违反里氏替换原则 (LSP)",
      "root_cause": "子类修改了参数类型从 dict 到 str",
      "cwe_id": "CWE-685",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "07_type_safety\\api_contract\\positive\\example1_api_contract.py"
    },
    {
      "id": "TYPE-API-003",
      "category": "type_safety",
      "subcategory": "api_contract",
      "severity": "critical",
      "type": "AbstractMethodNotImplemented",
      "file": "example1_api_contract.py",
      "function": "IncompleteProcessor",
      "location": {
        "start_line": 104,
        "end_line": 104,
        "start_col": 0,
        "end_col": 35
      },
      "description": "抽象类的子类未实现所有抽象方法",
      "root_cause": "IncompleteProcessor 缺少 validate 方法实现",
      "cwe_id": "CWE-477",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "07_type_safety\\api_contract\\positive\\example1_api_contract.py"
    },
    {
      "id": "TYPE-API-004",
      "category": "type_safety",
      "subcategory": "api_contract",
      "severity": "high",
      "type": "ReturnTypeInconsistent",
      "file": "example1_api_contract.py",
      "function": "get_user_age",
      "location": {
        "start_line": 133,
        "end_line": 133,
        "start_col": 4,
        "end_col": 16
      },
      "description": "函数声明返回 int，但实际可能返回 None",
      "root_cause": "返回类型注解与实际返回值不一致",
      "cwe_id": "CWE-704",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "07_type_safety\\api_contract\\positive\\example1_api_contract.py"
    },
    {
      "id": "TYPE-MIS-001",
      "category": "type_safety",
      "subcategory": "type_mismatch",
      "severity": "high",
      "type": "ParameterTypeMismatch",
      "file": "example1_type_errors.py",
      "function": "calculate_total",
      "location": {
        "start_line": 16,
        "end_line": 16,
        "start_col": 4,
        "end_col": 21
      },
      "description": "参数类型不匹配，声明 List[int] 但可能传入 str",
      "root_cause": "类型注解与实际调用不匹配，缺少运行时验证",
      "cwe_id": "CWE-704",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "07_type_safety\\type_mismatch\\positive\\example1_type_errors.py"
    },
    {
      "id": "TYPE-MIS-002",
      "category": "type_safety",
      "subcategory": "type_mismatch",
      "severity": "high",
      "type": "ReturnTypeMismatch",
      "file": "example1_type_errors.py",
      "function": "get_user_name",
      "location": {
        "start_line": 30,
        "end_line": 30,
        "start_col": 8,
        "end_col": 19
      },
      "description": "返回类型不匹配，声明返回 str 实际返回 dict",
      "root_cause": "函数签名与实现不一致",
      "cwe_id": "CWE-704",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "07_type_safety\\type_mismatch\\positive\\example1_type_errors.py"
    },
    {
      "id": "TYPE-MIS-003",
      "category": "type_safety",
      "subcategory": "type_mismatch",
      "severity": "high",
      "type": "ContainerTypeMismatch",
      "file": "example1_type_errors.py",
      "function": "process_numbers",
      "location": {
        "start_line": 44,
        "end_line": 44,
        "start_col": 4,
        "end_col": 49
      },
      "description": "容器类型错误，List[int] 注解但包含 str 元素",
      "root_cause": "列表元素类型与注解不符",
      "cwe_id": "CWE-704",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "07_type_safety\\type_mismatch\\positive\\example1_type_errors.py"
    },
    {
      "id": "DATA-FLOW-001",
      "category": "data_flow_issues",
      "subcategory": "control_flow",
      "severity": "low",
      "type": "UnreachableCode",
      "file": "example1_dead_code.py",
      "function": "process_data",
      "location": {
        "start_line": 22,
        "end_line": 23,
        "start_col": 4,
        "end_col": 26
      },
      "description": "return 后的代码不可达，清理和日志代码永远不会执行",
      "root_cause": "return 语句后的代码无法到达",
      "cwe_id": "CWE-561",
      "difficulty": "low",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "06_data_flow_issues\\control_flow\\positive\\example1_dead_code.py"
    },
    {
      "id": "DATA-FLOW-002",
      "category": "data_flow_issues",
      "subcategory": "control_flow",
      "severity": "low",
      "type": "ConstantCondition",
      "file": "example1_dead_code.py",
      "function": "validate_age",
      "location": {
        "start_line": 38,
        "end_line": 39,
        "start_col": 4,
        "end_col": 21
      },
      "description": "恒假条件 (1 == 2)，分支代码永远不会执行",
      "root_cause": "条件表达式恒为 False，可能是逻辑错误",
      "cwe_id": "CWE-570",
      "difficulty": "low",
      "related_bugs": [],
      "detection_layer": "Layer 1/2",
      "relative_path": "06_data_flow_issues\\control_flow\\positive\\example1_dead_code.py"
    },
    {
      "id": "DATA-FLOW-003",
      "category": "data_flow_issues",
      "subcategory": "control_flow",
      "severity": "medium",
      "type": "InfiniteLoop",
      "file": "example1_dead_code.py",
      "function": "wait_for_signal",
      "location": {
        "start_line": 56,
        "end_line": 60,
        "start_col": 4,
        "end_col": 35
      },
      "description": "while True 无 break 语句，导致无限循环",
      "root_cause": "循环缺少退出条件",
      "cwe_id": "CWE-835",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 3",
      "relative_path": "06_data_flow_issues\\control_flow\\positive\\example1_dead_code.py"
    },
    {
      "id": "DATA-FLOW-004",
      "category": "data_flow_issues",
      "subcategory": "control_flow",
      "severity": "high",
      "type": "InfiniteRecursion",
      "file": "example1_dead_code.py",
      "function": "process_recursive",
      "location": {
        "start_line": 75,
        "end_line": 75,
        "start_col": 4,
        "end_col": 47
      },
      "description": "递归函数缺少终止条件，导致 RecursionError",
      "root_cause": "递归调用缺少基本情况 (base case)",
      "cwe_id": "CWE-674",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 2/3",
      "relative_path": "06_data_flow_issues\\control_flow\\positive\\example1_dead_code.py"
    },
    {
      "id": "DATA-NULL-001",
      "category": "data_flow_issues",
      "subcategory": "none_dereference",
      "severity": "high",
      "type": "NullPointerDereference",
      "file": "example1_none_access.py",
      "function": "get_user_email",
      "location": {
        "start_line": 16,
        "end_line": 16,
        "start_col": 4,
        "end_col": 24
      },
      "description": "Optional 类型未检查直接访问属性，user 可能是 None",
      "root_cause": "函数返回 Optional[dict]，未检查 None 就访问键",
      "cwe_id": "CWE-476",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 1/2",
      "relative_path": "06_data_flow_issues\\none_dereference\\positive\\example1_none_access.py"
    },
    {
      "id": "DATA-NULL-002",
      "category": "data_flow_issues",
      "subcategory": "none_dereference",
      "severity": "high",
      "type": "NullPointerDereference",
      "file": "example1_none_access.py",
      "function": "get_config_value",
      "location": {
        "start_line": 29,
        "end_line": 29,
        "start_col": 4,
        "end_col": 22
      },
      "description": "dict.get() 返回 None 未检查，直接调用方法引发 AttributeError",
      "root_cause": "get() 返回值可能是 None，未检查就调用 .upper()",
      "cwe_id": "CWE-476",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 2/3",
      "relative_path": "06_data_flow_issues\\none_dereference\\positive\\example1_none_access.py"
    },
    {
      "id": "DATA-NULL-003",
      "category": "data_flow_issues",
      "subcategory": "none_dereference",
      "severity": "high",
      "type": "IndexOutOfBounds",
      "file": "example1_none_access.py",
      "function": "unsafe_get_first",
      "location": {
        "start_line": 48,
        "end_line": 48,
        "start_col": 4,
        "end_col": 21
      },
      "description": "未检查列表是否为空直接索引，空列表引发 IndexError",
      "root_cause": "未验证列表长度就访问 items[0]",
      "cwe_id": "CWE-476",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "06_data_flow_issues\\none_dereference\\positive\\example1_none_access.py"
    },
    {
      "id": "DATA-NULL-004",
      "category": "data_flow_issues",
      "subcategory": "none_dereference",
      "severity": "high",
      "type": "KeyError",
      "file": "example1_none_access.py",
      "function": "get_required_field",
      "location": {
        "start_line": 59,
        "end_line": 59,
        "start_col": 4,
        "end_col": 22
      },
      "description": "使用 [] 访问可能不存在的字典键，引发 KeyError",
      "root_cause": "应使用 .get() 或 in 检查，而不是直接 []",
      "cwe_id": "CWE-476",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "06_data_flow_issues\\none_dereference\\positive\\example1_none_access.py"
    },
    {
      "id": "DATA-NULL-005",
      "category": "data_flow_issues",
      "subcategory": "none_dereference",
      "severity": "medium",
      "type": "InvalidIndex",
      "file": "example1_none_access.py",
      "function": "extract_domain",
      "location": {
        "start_line": 70,
        "end_line": 70,
        "start_col": 4,
        "end_col": 24
      },
      "description": "str.find() 返回 -1 未检查，导致切片结果错误",
      "root_cause": "find() 未找到时返回 -1，未检查就用于索引",
      "cwe_id": "CWE-476",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2/3",
      "relative_path": "06_data_flow_issues\\none_dereference\\positive\\example1_none_access.py"
    },
    {
      "id": "DATA-INIT-001",
      "category": "data_flow_issues",
      "subcategory": "variable_initialization",
      "severity": "high",
      "type": "UninitializedVariable",
      "file": "example1_uninitialized.py",
      "function": "process_payment",
      "location": {
        "start_line": 18,
        "end_line": 18,
        "start_col": 4,
        "end_col": 41
      },
      "description": "条件分支中变量未初始化，else 分支中 transaction_id 未定义",
      "root_cause": "部分分支未初始化变量，导致后续使用时 UnboundLocalError",
      "cwe_id": "CWE-457",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "06_data_flow_issues\\variable_initialization\\positive\\example1_uninitialized.py"
    },
    {
      "id": "DATA-INIT-002",
      "category": "data_flow_issues",
      "subcategory": "variable_initialization",
      "severity": "medium",
      "type": "UninitializedVariable",
      "file": "example1_uninitialized.py",
      "function": "find_max_value",
      "location": {
        "start_line": 33,
        "end_line": 33,
        "start_col": 4,
        "end_col": 18
      },
      "description": "循环内初始化变量，空列表时变量未定义",
      "root_cause": "未在循环外初始化，空迭代时引发 UnboundLocalError",
      "cwe_id": "CWE-457",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "06_data_flow_issues\\variable_initialization\\positive\\example1_uninitialized.py"
    },
    {
      "id": "DATA-INIT-003",
      "category": "data_flow_issues",
      "subcategory": "variable_initialization",
      "severity": "high",
      "type": "UninitializedVariable",
      "file": "example1_uninitialized.py",
      "function": "load_config",
      "location": {
        "start_line": 50,
        "end_line": 50,
        "start_col": 4,
        "end_col": 34
      },
      "description": "异常分支未初始化变量，except 块后 config 未定义",
      "root_cause": "try 块初始化但 except 未初始化，异常后使用引发错误",
      "cwe_id": "CWE-457",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "06_data_flow_issues\\variable_initialization\\positive\\example1_uninitialized.py"
    },
    {
      "id": "DATA-INIT-004",
      "category": "data_flow_issues",
      "subcategory": "variable_initialization",
      "severity": "high",
      "type": "UninitializedVariable",
      "file": "example1_uninitialized.py",
      "function": "calculate_discount",
      "location": {
        "start_line": 60,
        "end_line": 60,
        "start_col": 8,
        "end_col": 41
      },
      "description": "变量在定义前引用，discount_rate 在赋值前使用",
      "root_cause": "变量使用先于定义，直接引发 UnboundLocalError",
      "cwe_id": "CWE-457",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "06_data_flow_issues\\variable_initialization\\positive\\example1_uninitialized.py"
    },
    {
      "id": "DATA-INIT-005",
      "category": "data_flow_issues",
      "subcategory": "variable_initialization",
      "severity": "medium",
      "type": "UninitializedVariable",
      "file": "example1_uninitialized.py",
      "function": "increment_counter",
      "location": {
        "start_line": 77,
        "end_line": 77,
        "start_col": 4,
        "end_col": 18
      },
      "description": "global 声明但未验证全局变量是否存在",
      "root_cause": "假设全局变量已定义，可能在运行时被删除",
      "cwe_id": "CWE-457",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "06_data_flow_issues\\variable_initialization\\positive\\example1_uninitialized.py"
    },
    {
      "id": "DATA-INIT-006",
      "category": "data_flow_issues",
      "subcategory": "variable_initialization",
      "severity": "medium",
      "type": "UninitializedVariable",
      "file": "example1_uninitialized.py",
      "function": "add_item",
      "location": {
        "start_line": 92,
        "end_line": 92,
        "start_col": 8,
        "end_col": 29
      },
      "description": "类实例变量未在 __init__ 中初始化，直接使用引发 AttributeError",
      "root_cause": "__init__ 未初始化 self.total，add_item 直接使用",
      "cwe_id": "CWE-457",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "06_data_flow_issues\\variable_initialization\\positive\\example1_uninitialized.py"
    },
    {
      "id": "INJ-CMD-001",
      "category": "injection_flaws",
      "subcategory": "command_injection",
      "severity": "critical",
      "type": "CommandInjection",
      "file": "example1_os_system.py",
      "function": "backup_file",
      "location": {
        "start_line": 35,
        "end_line": 35,
        "start_col": 4,
        "end_col": 23
      },
      "description": "使用 os.system 拼接用户输入,可执行任意系统命令",
      "root_cause": "未验证用户输入,直接拼接到 shell 命令中",
      "cwe_id": "CWE-78",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1/2",
      "relative_path": "05_injection_flaws\\command_injection\\positive\\example1_os_system.py"
    },
    {
      "id": "INJ-CMD-002",
      "category": "injection_flaws",
      "subcategory": "command_injection",
      "severity": "critical",
      "type": "CommandInjection",
      "file": "example1_os_system.py",
      "function": "execute_command_subprocess",
      "location": {
        "start_line": 166,
        "end_line": 166,
        "start_col": 4,
        "end_col": 43
      },
      "description": "subprocess.Popen 使用 shell=True 拼接命令，可执行任意命令",
      "root_cause": "shell=True 启用 shell 解释，未验证用户输入",
      "cwe_id": "CWE-78",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "05_injection_flaws\\command_injection\\positive\\example1_os_system.py"
    },
    {
      "id": "INJ-CMD-003",
      "category": "injection_flaws",
      "subcategory": "command_injection",
      "severity": "critical",
      "type": "CodeInjection",
      "file": "example1_os_system.py",
      "function": "calculate_expression",
      "location": {
        "start_line": 179,
        "end_line": 179,
        "start_col": 4,
        "end_col": 25
      },
      "description": "eval() 直接执行用户输入的表达式，可执行任意 Python 代码",
      "root_cause": "eval 动态执行代码，未进行任何验证",
      "cwe_id": "CWE-94",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "05_injection_flaws\\command_injection\\positive\\example1_os_system.py"
    },
    {
      "id": "INJ-CMD-004",
      "category": "injection_flaws",
      "subcategory": "command_injection",
      "severity": "critical",
      "type": "CommandInjection",
      "file": "example1_os_system.py",
      "function": "list_directory_popen",
      "location": {
        "start_line": 194,
        "end_line": 194,
        "start_col": 4,
        "end_col": 32
      },
      "description": "os.popen() 拼接用户输入执行 shell 命令，可注入任意命令",
      "root_cause": "os.popen 启用 shell，未验证用户输入",
      "cwe_id": "CWE-78",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "05_injection_flaws\\command_injection\\positive\\example1_os_system.py"
    },
    {
      "id": "INJ-CMD-005",
      "category": "injection_flaws",
      "subcategory": "command_injection",
      "severity": "critical",
      "type": "CodeInjection",
      "file": "example1_os_system.py",
      "function": "execute_user_code",
      "location": {
        "start_line": 214,
        "end_line": 214,
        "start_col": 4,
        "end_col": 14
      },
      "description": "exec() 执行用户提供的代码字符串，可执行任意 Python 代码",
      "root_cause": "exec 动态执行代码，未进行任何验证",
      "cwe_id": "CWE-94",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "05_injection_flaws\\command_injection\\positive\\example1_os_system.py"
    },
    {
      "id": "INJ-CMD-006",
      "category": "injection_flaws",
      "subcategory": "command_injection",
      "severity": "critical",
      "type": "CodeInjection",
      "file": "example1_os_system.py",
      "function": "compile_and_run",
      "location": {
        "start_line": 228,
        "end_line": 228,
        "start_col": 4,
        "end_col": 61
      },
      "description": "compile() + exec() 组合执行用户代码，可执行任意 Python 代码",
      "root_cause": "compile 编译并执行用户输入的代码",
      "cwe_id": "CWE-94",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "05_injection_flaws\\command_injection\\positive\\example1_os_system.py"
    },
    {
      "id": "INJ-PATH-001",
      "category": "injection_flaws",
      "subcategory": "path_traversal",
      "severity": "high",
      "type": "PathTraversal",
      "file": "example1_path_injection.py",
      "function": "read_user_file",
      "location": {
        "start_line": 17,
        "end_line": 17,
        "start_col": 4,
        "end_col": 50
      },
      "description": "用户输入直接拼接路径，可通过 '../' 访问任意文件",
      "root_cause": "路径拼接未验证，缺少路径规范化",
      "cwe_id": "CWE-22",
      "difficulty": "high",
      "related_bugs": [
        "BUG_0014"
      ],
      "relative_path": "05_injection_flaws\\path_traversal\\positive\\example1_path_injection.py"
    },
    {
      "id": "INJ-PATH-002",
      "category": "injection_flaws",
      "subcategory": "path_traversal",
      "severity": "high",
      "type": "PathTraversal",
      "file": "example1_path_injection.py",
      "function": "download_file",
      "location": {
        "start_line": 32,
        "end_line": 32,
        "start_col": 4,
        "end_col": 45
      },
      "description": "file_id 直接拼接到路径，可能包含 '../' 导致路径遍历",
      "root_cause": "用户输入未验证直接用于文件路径",
      "cwe_id": "CWE-22",
      "difficulty": "high",
      "related_bugs": [
        "BUG_0014"
      ],
      "relative_path": "05_injection_flaws\\path_traversal\\positive\\example1_path_injection.py"
    },
    {
      "id": "INJ-PATH-003",
      "category": "injection_flaws",
      "subcategory": "path_traversal",
      "severity": "high",
      "type": "PathTraversal",
      "file": "example1_path_injection.py",
      "function": "serve_static_file",
      "location": {
        "start_line": 46,
        "end_line": 46,
        "start_col": 4,
        "end_col": 54
      },
      "description": "路径检查不足，可能被符号链接或特殊字符绕过",
      "root_cause": "使用 startswith 检查不够严格，应该使用 resolve()",
      "cwe_id": "CWE-22",
      "difficulty": "high",
      "related_bugs": [
        "BUG_0014"
      ],
      "relative_path": "05_injection_flaws\\path_traversal\\positive\\example1_path_injection.py"
    },
    {
      "id": "INJ-PATH-004",
      "category": "injection_flaws",
      "subcategory": "path_traversal",
      "severity": "high",
      "type": "PathTraversal",
      "file": "example1_path_injection.py",
      "function": "delete_user_upload",
      "location": {
        "start_line": 62,
        "end_line": 62,
        "start_col": 4,
        "end_col": 54
      },
      "description": "filename 可能包含 '../' 删除其他用户文件",
      "root_cause": "文件名未验证，允许目录遍历",
      "cwe_id": "CWE-22",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0014"
      ],
      "relative_path": "05_injection_flaws\\path_traversal\\positive\\example1_path_injection.py"
    },
    {
      "id": "INJ-PATH-005",
      "category": "injection_flaws",
      "subcategory": "path_traversal",
      "severity": "high",
      "type": "PathTraversal",
      "file": "example1_path_injection.py",
      "function": "load_template",
      "location": {
        "start_line": 78,
        "end_line": 78,
        "start_col": 4,
        "end_col": 58
      },
      "description": "模板名称未验证，可能导致任意文件读取",
      "root_cause": "用户输入直接用于模板路径",
      "cwe_id": "CWE-22",
      "difficulty": "high",
      "related_bugs": [
        "BUG_0014"
      ],
      "relative_path": "05_injection_flaws\\path_traversal\\positive\\example1_path_injection.py"
    },
    {
      "id": "INJ-PATH-006",
      "category": "injection_flaws",
      "subcategory": "path_traversal",
      "severity": "high",
      "type": "TOCTOU",
      "file": "example2_symlink_attack.py",
      "function": "safe_write_to_user_dir",
      "location": {
        "start_line": 19,
        "end_line": 26,
        "start_col": 4,
        "end_col": 22
      },
      "description": "检查和使用之间存在时间窗口，可能被符号链接攻击",
      "root_cause": "TOCTOU 漏洞：检查后使用前文件可能被替换",
      "cwe_id": "CWE-367",
      "difficulty": "hard",
      "related_bugs": [
        "BUG_0014"
      ],
      "relative_path": "05_injection_flaws\\path_traversal\\positive\\example2_symlink_attack.py"
    },
    {
      "id": "INJ-PATH-007",
      "category": "injection_flaws",
      "subcategory": "path_traversal",
      "severity": "high",
      "type": "SymlinkNotChecked",
      "file": "example2_symlink_attack.py",
      "function": "read_config_file",
      "location": {
        "start_line": 39,
        "end_line": 41,
        "start_col": 4,
        "end_col": 28
      },
      "description": "未检查是否为符号链接，可能读取任意文件",
      "root_cause": "缺少符号链接检查",
      "cwe_id": "CWE-59",
      "difficulty": "hard",
      "related_bugs": [
        "BUG_0014"
      ],
      "relative_path": "05_injection_flaws\\path_traversal\\positive\\example2_symlink_attack.py"
    },
    {
      "id": "INJ-PATH-008",
      "category": "injection_flaws",
      "subcategory": "path_traversal",
      "severity": "high",
      "type": "ZipSlip",
      "file": "example2_symlink_attack.py",
      "function": "extract_archive_to_user_space",
      "location": {
        "start_line": 58,
        "end_line": 59,
        "start_col": 8,
        "end_col": 35
      },
      "description": "压缩包解压未验证成员路径，可能覆盖任意文件（Zip Slip）",
      "root_cause": "未验证压缩包成员路径，允许 '../' 路径",
      "cwe_id": "CWE-22",
      "difficulty": "hard",
      "related_bugs": [
        "BUG_0014"
      ],
      "relative_path": "05_injection_flaws\\path_traversal\\positive\\example2_symlink_attack.py"
    },
    {
      "id": "INJ-PATH-009",
      "category": "injection_flaws",
      "subcategory": "path_traversal",
      "severity": "medium",
      "type": "TOCTOU",
      "file": "example2_symlink_attack.py",
      "function": "check_and_delete_temp_file",
      "location": {
        "start_line": 76,
        "end_line": 81,
        "start_col": 4,
        "end_col": 33
      },
      "description": "检查后删除前文件可能被替换为符号链接",
      "root_cause": "TOCTOU：检查和删除之间存在竞态窗口",
      "cwe_id": "CWE-367",
      "difficulty": "hard",
      "relative_path": "05_injection_flaws\\path_traversal\\positive\\example2_symlink_attack.py"
    },
    {
      "id": "INPUT-PATH-003",
      "category": "injection_flaws",
      "subcategory": "path_traversal",
      "severity": "high",
      "type": "PathTraversal",
      "file": "example3_zip_traversal.py",
      "function": "extract_zip_unsafe",
      "location": {
        "start_line": 17,
        "end_line": 17,
        "start_col": 8,
        "end_col": 38
      },
      "description": "zipfile.extractall() 未验证路径，可解压到任意位置覆盖文件",
      "root_cause": "未检查 ZIP 成员路径是否包含 ../ 等路径遍历字符",
      "cwe_id": "CWE-22",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "05_injection_flaws\\path_traversal\\positive\\example3_zip_traversal.py"
    },
    {
      "id": "INJ-SQL-001",
      "category": "injection_flaws",
      "subcategory": "sql_injection",
      "severity": "critical",
      "type": "SQLInjection",
      "file": "example1_sql_injection.py",
      "function": "get_user_by_id",
      "location": {
        "start_line": 20,
        "end_line": 20,
        "start_col": 4,
        "end_col": 57
      },
      "description": "使用 f-string 拼接 SQL 查询，可注入任意 SQL 代码",
      "root_cause": "未使用参数化查询，直接拼接用户输入",
      "cwe_id": "CWE-89",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "05_injection_flaws\\sql_injection\\positive\\example1_sql_injection.py"
    },
    {
      "id": "INJ-SQL-002",
      "category": "injection_flaws",
      "subcategory": "sql_injection",
      "severity": "critical",
      "type": "SQLInjection",
      "file": "example1_sql_injection.py",
      "function": "search_users",
      "location": {
        "start_line": 39,
        "end_line": 39,
        "start_col": 4,
        "end_col": 83
      },
      "description": "使用 format() 拼接表名和查询条件，可执行任意 SQL",
      "root_cause": "表名和条件未验证，直接使用 format 拼接",
      "cwe_id": "CWE-89",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "05_injection_flaws\\sql_injection\\positive\\example1_sql_injection.py"
    },
    {
      "id": "VAL-INPUT-001",
      "category": "input_validation",
      "subcategory": "api_input_validation",
      "severity": "high",
      "type": "MissingInputValidation",
      "file": "example1_missing_validation.py",
      "function": "create_user",
      "location": {
        "start_line": 10,
        "end_line": 22,
        "start_col": 4,
        "end_col": 16
      },
      "description": "公共 API 缺少参数校验（username, email, age 均未验证）",
      "root_cause": "缺少输入验证，可能导致数据损坏或安全问题",
      "cwe_id": "CWE-20",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0012"
      ],
      "relative_path": "04_input_validation\\api_input_validation\\positive\\example1_missing_validation.py"
    },
    {
      "id": "VAL-INPUT-002",
      "category": "input_validation",
      "subcategory": "api_input_validation",
      "severity": "high",
      "type": "MissingWhitelist",
      "file": "example1_missing_validation.py",
      "function": "update_config",
      "location": {
        "start_line": 33,
        "end_line": 34,
        "start_col": 4,
        "end_col": 16
      },
      "description": "缺少配置键白名单，可能覆盖敏感配置",
      "root_cause": "允许任意 key，应该使用白名单限制",
      "cwe_id": "CWE-20",
      "difficulty": "high",
      "related_bugs": [
        "BUG_0012"
      ],
      "relative_path": "04_input_validation\\api_input_validation\\positive\\example1_missing_validation.py"
    },
    {
      "id": "VAL-INPUT-003",
      "category": "input_validation",
      "subcategory": "api_input_validation",
      "severity": "high",
      "type": "MissingRoleValidation",
      "file": "example1_missing_validation.py",
      "function": "set_user_role",
      "location": {
        "start_line": 47,
        "end_line": 48,
        "start_col": 4,
        "end_col": 42
      },
      "description": "缺少角色白名单验证，可能导致权限提升",
      "root_cause": "允许任意角色字符串",
      "cwe_id": "CWE-20",
      "difficulty": "high",
      "related_bugs": [
        "BUG_0012",
        "BUG_0013"
      ],
      "relative_path": "04_input_validation\\api_input_validation\\positive\\example1_missing_validation.py"
    },
    {
      "id": "VAL-INPUT-004",
      "category": "input_validation",
      "subcategory": "api_input_validation",
      "severity": "medium",
      "type": "MissingRangeValidation",
      "file": "example1_missing_validation.py",
      "function": "search_users",
      "location": {
        "start_line": 61,
        "end_line": 61,
        "start_col": 4,
        "end_col": 27
      },
      "description": "limit 参数缺少范围验证，可能导致资源耗尽",
      "root_cause": "未验证 limit 范围，可能是负数或超大值",
      "cwe_id": "CWE-20",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0012"
      ],
      "relative_path": "04_input_validation\\api_input_validation\\positive\\example1_missing_validation.py"
    },
    {
      "id": "VAL-INPUT-005",
      "category": "input_validation",
      "subcategory": "api_input_validation",
      "severity": "high",
      "type": "MissingPathValidation",
      "file": "example1_missing_validation.py",
      "function": "delete_file",
      "location": {
        "start_line": 76,
        "end_line": 78,
        "start_col": 4,
        "end_col": 24
      },
      "description": "公共 API 允许删除任意路径文件",
      "root_cause": "缺少路径验证，应该限制在特定目录内",
      "cwe_id": "CWE-22",
      "difficulty": "high",
      "related_bugs": [
        "BUG_0012"
      ],
      "relative_path": "04_input_validation\\api_input_validation\\positive\\example1_missing_validation.py"
    },
    {
      "id": "VAL-INPUT-006",
      "category": "input_validation",
      "subcategory": "api_input_validation",
      "severity": "medium",
      "type": "InconsistentReturnType",
      "file": "example2_inconsistent_return.py",
      "function": "get_user_by_id",
      "location": {
        "start_line": 17,
        "end_line": 24,
        "start_col": 4,
        "end_col": 24
      },
      "description": "返回类型不一致：成功返回 dict，失败返回 None 或抛出异常",
      "root_cause": "应该统一：始终返回 Optional[Dict] 或始终抛出异常",
      "cwe_id": "CWE-704",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0013"
      ],
      "relative_path": "04_input_validation\\api_input_validation\\positive\\example2_inconsistent_return.py"
    },
    {
      "id": "VAL-INPUT-007",
      "category": "input_validation",
      "subcategory": "api_input_validation",
      "severity": "medium",
      "type": "InconsistentReturnType",
      "file": "example2_inconsistent_return.py",
      "function": "calculate_average",
      "location": {
        "start_line": 35,
        "end_line": 36,
        "start_col": 4,
        "end_col": 41
      },
      "description": "返回类型不一致：空列表返回 int(0)，非空返回 float",
      "root_cause": "应该统一返回 float 或抛出异常",
      "cwe_id": "CWE-704",
      "difficulty": "easy",
      "related_bugs": [
        "BUG_0013"
      ],
      "relative_path": "04_input_validation\\api_input_validation\\positive\\example2_inconsistent_return.py"
    },
    {
      "id": "VAL-INPUT-008",
      "category": "input_validation",
      "subcategory": "api_input_validation",
      "severity": "medium",
      "type": "InconsistentReturnType",
      "file": "example2_inconsistent_return.py",
      "function": "find_items",
      "location": {
        "start_line": 51,
        "end_line": 56,
        "start_col": 4,
        "end_col": 22
      },
      "description": "返回类型不一致：找到返回 list，未找到返回 bool(False)",
      "root_cause": "应该始终返回列表（空列表表示未找到）",
      "cwe_id": "CWE-704",
      "difficulty": "easy",
      "related_bugs": [
        "BUG_0013"
      ],
      "relative_path": "04_input_validation\\api_input_validation\\positive\\example2_inconsistent_return.py"
    },
    {
      "id": "VAL-INPUT-009",
      "category": "input_validation",
      "subcategory": "api_input_validation",
      "severity": "medium",
      "type": "InconsistentReturnType",
      "file": "example2_inconsistent_return.py",
      "function": "parse_json_response",
      "location": {
        "start_line": 70,
        "end_line": 73,
        "start_col": 4,
        "end_col": 31
      },
      "description": "返回类型不一致：成功返回 dict，失败返回 str 错误消息",
      "root_cause": "应该抛出异常或返回 None，而不是返回错误字符串",
      "cwe_id": "CWE-704",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0013"
      ],
      "relative_path": "04_input_validation\\api_input_validation\\positive\\example2_inconsistent_return.py"
    },
    {
      "id": "VAL-INPUT-010",
      "category": "input_validation",
      "subcategory": "api_input_validation",
      "severity": "low",
      "type": "UnclearReturnType",
      "file": "example2_inconsistent_return.py",
      "function": "get_config_value",
      "location": {
        "start_line": 85,
        "end_line": 85,
        "start_col": 4,
        "end_col": 39
      },
      "description": "返回值类型取决于 default 参数，调用者无法确定类型",
      "root_cause": "应该使用泛型或明确返回类型",
      "cwe_id": "CWE-704",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0013"
      ],
      "relative_path": "04_input_validation\\api_input_validation\\positive\\example2_inconsistent_return.py"
    },
    {
      "id": "EXC-CATCH-001",
      "category": "error_handling",
      "subcategory": "exception_catching",
      "severity": "medium",
      "type": "OverBroadException",
      "file": "example2_exception_type.py",
      "function": "parse_config",
      "location": {
        "start_line": 17,
        "end_line": 17,
        "start_col": 4,
        "end_col": 21
      },
      "description": "捕获过于宽泛的 Exception,会掩盖 KeyboardInterrupt 等系统异常",
      "root_cause": "应该捕获具体的 json.JSONDecodeError",
      "cwe_id": "CWE-396",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0008"
      ],
      "relative_path": "03_error_handling\\exception_catching\\positive\\example2_exception_type.py"
    },
    {
      "id": "EXC-CATCH-002",
      "category": "error_handling",
      "subcategory": "exception_catching",
      "severity": "high",
      "type": "WrongExceptionType",
      "file": "example2_exception_type.py",
      "function": "divide_numbers",
      "location": {
        "start_line": 30,
        "end_line": 30,
        "start_col": 4,
        "end_col": 22
      },
      "description": "捕获了错误的异常类型 ValueError,实际应该捕获 ZeroDivisionError",
      "root_cause": "异常类型不匹配",
      "cwe_id": "CWE-396",
      "difficulty": "easy",
      "related_bugs": [
        "BUG_0008"
      ],
      "relative_path": "03_error_handling\\exception_catching\\positive\\example2_exception_type.py"
    },
    {
      "id": "EXC-CATCH-003",
      "category": "error_handling",
      "subcategory": "exception_catching",
      "severity": "medium",
      "type": "IncompleteExceptionHandling",
      "file": "example2_exception_type.py",
      "function": "read_integer_from_file",
      "location": {
        "start_line": 44,
        "end_line": 46,
        "start_col": 8,
        "end_col": 30
      },
      "description": "只捕获了 ValueError,但可能抛出 FileNotFoundError, IOError 等",
      "root_cause": "异常处理不完整",
      "cwe_id": "CWE-755",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0008"
      ],
      "relative_path": "03_error_handling\\exception_catching\\positive\\example2_exception_type.py"
    },
    {
      "id": "EXC-CATCH-004",
      "category": "error_handling",
      "subcategory": "exception_catching",
      "severity": "high",
      "type": "BareExcept",
      "file": "example2_exception_type.py",
      "function": "process_user_input",
      "location": {
        "start_line": 61,
        "end_line": 61,
        "start_col": 4,
        "end_col": 11
      },
      "description": "使用裸 except: 会捕获所有异常,包括 KeyboardInterrupt",
      "root_cause": "裸 except 违反最佳实践",
      "cwe_id": "CWE-396",
      "difficulty": "easy",
      "related_bugs": [
        "BUG_0008"
      ],
      "relative_path": "03_error_handling\\exception_catching\\positive\\example2_exception_type.py"
    },
    {
      "id": "EXC-CATCH-005",
      "category": "error_handling",
      "subcategory": "exception_catching",
      "severity": "medium",
      "type": "SilentException",
      "file": "example2_exception_type.py",
      "function": "save_important_data",
      "location": {
        "start_line": 85,
        "end_line": 86,
        "start_col": 4,
        "end_col": 12
      },
      "description": "except 仅 pass，完全吞掉异常，无任何处理或日志",
      "root_cause": "数据保存失败但程序继续运行，用户误以为操作成功",
      "cwe_id": "CWE-391",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "03_error_handling\\exception_catching\\positive\\example2_exception_type.py"
    },
    {
      "id": "EXC-CATCH-006",
      "category": "error_handling",
      "subcategory": "exception_catching",
      "severity": "medium",
      "type": "UnloggedException",
      "file": "example2_exception_type.py",
      "function": "fetch_critical_config",
      "location": {
        "start_line": 103,
        "end_line": 105,
        "start_col": 4,
        "end_col": 20
      },
      "description": "异常捕获后未记录日志，直接返回 None，生产环境问题难以排查",
      "root_cause": "配置加载失败但无日志记录",
      "cwe_id": "CWE-391",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "03_error_handling\\exception_catching\\positive\\example2_exception_type.py"
    },
    {
      "id": "EXC-CATCH-007",
      "category": "error_handling",
      "subcategory": "exception_catching",
      "severity": "critical",
      "type": "CatchingBaseException",
      "file": "example2_exception_type.py",
      "function": "critical_operation",
      "location": {
        "start_line": 125,
        "end_line": 125,
        "start_col": 4,
        "end_col": 26
      },
      "description": "捕获 BaseException，会拦截 SystemExit 和 KeyboardInterrupt",
      "root_cause": "使用 BaseException 而不是 Exception，导致程序无法正常退出",
      "cwe_id": "CWE-396",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "03_error_handling\\exception_catching\\positive\\example2_exception_type.py"
    },
    {
      "id": "EXC-CATCH-008",
      "category": "error_handling",
      "subcategory": "exception_catching",
      "severity": "low",
      "type": "RedundantExceptBranch",
      "file": "example2_exception_type.py",
      "function": "redundant_exception_handling",
      "location": {
        "start_line": 148,
        "end_line": 148,
        "start_col": 4,
        "end_col": 25
      },
      "description": "多余的 except 分支（死代码），ValueError 已被 Exception 捕获",
      "root_cause": "except 顺序错误，子类异常永远不会被执行",
      "cwe_id": "CWE-561",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "03_error_handling\\exception_catching\\positive\\example2_exception_type.py"
    },
    {
      "id": "EXC-CATCH-009",
      "category": "error_handling",
      "subcategory": "exception_catching",
      "severity": "medium",
      "type": "WrongExceptionOrder",
      "file": "example2_exception_type.py",
      "function": "wrong_exception_order",
      "location": {
        "start_line": 171,
        "end_line": 171,
        "start_col": 4,
        "end_col": 23
      },
      "description": "except 顺序错误，父类 OSError 先于子类 FileNotFoundError",
      "root_cause": "应该先捕获具体异常（子类），再捕获一般异常（父类）",
      "cwe_id": "CWE-484",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "03_error_handling\\exception_catching\\positive\\example2_exception_type.py"
    },
    {
      "id": "EXC-CLEAN-001",
      "category": "error_handling",
      "subcategory": "resource_cleanup",
      "severity": "high",
      "type": "ExceptionResourceLeak",
      "file": "example1_resource_cleanup.py",
      "function": "read_and_process_file",
      "location": {
        "start_line": 13,
        "end_line": 13,
        "start_col": 4,
        "end_col": 31
      },
      "description": "文件打开后,如果 process() 抛出异常,文件句柄不会被关闭",
      "root_cause": "异常处理缺少 finally 块来释放资源",
      "cwe_id": "CWE-755",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0007"
      ],
      "relative_path": "03_error_handling\\resource_cleanup\\positive\\example1_resource_cleanup.py"
    },
    {
      "id": "EXC-CLEAN-002",
      "category": "error_handling",
      "subcategory": "resource_cleanup",
      "severity": "high",
      "type": "ExceptionResourceLeak",
      "file": "example1_resource_cleanup.py",
      "function": "download_and_save",
      "location": {
        "start_line": 35,
        "end_line": 36,
        "start_col": 4,
        "end_col": 30
      },
      "description": "网络响应和文件在异常时都未关闭",
      "root_cause": "多个资源未在 finally 块中释放",
      "cwe_id": "CWE-755",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0007"
      ],
      "relative_path": "03_error_handling\\resource_cleanup\\positive\\example1_resource_cleanup.py"
    },
    {
      "id": "EXC-CLEAN-003",
      "category": "error_handling",
      "subcategory": "resource_cleanup",
      "severity": "high",
      "type": "ExceptionResourceLeak",
      "file": "example1_resource_cleanup.py",
      "function": "connect_and_query",
      "location": {
        "start_line": 58,
        "end_line": 59,
        "start_col": 4,
        "end_col": 35
      },
      "description": "数据库连接和游标在异常时未关闭",
      "root_cause": "数据库资源缺少 finally 块清理",
      "cwe_id": "CWE-755",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0007"
      ],
      "relative_path": "03_error_handling\\resource_cleanup\\positive\\example1_resource_cleanup.py"
    },
    {
      "id": "EXC-CLEAN-004",
      "category": "error_handling",
      "subcategory": "resource_cleanup",
      "severity": "high",
      "type": "MissingFinally",
      "file": "example3_finally_missing.py",
      "function": "acquire_and_use_lock",
      "location": {
        "start_line": 15,
        "end_line": 15,
        "start_col": 4,
        "end_col": 18
      },
      "description": "锁的 acquire() 后缺少 finally 块来 release(),可能导致死锁",
      "root_cause": "缺少 finally 块释放锁",
      "cwe_id": "CWE-667",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0009"
      ],
      "relative_path": "03_error_handling\\resource_cleanup\\positive\\example3_finally_missing.py"
    },
    {
      "id": "EXC-CLEAN-005",
      "category": "error_handling",
      "subcategory": "resource_cleanup",
      "severity": "high",
      "type": "MissingFinally",
      "file": "example3_finally_missing.py",
      "function": "manual_file_handling",
      "location": {
        "start_line": 34,
        "end_line": 34,
        "start_col": 4,
        "end_col": 31
      },
      "description": "文件在正常路径关闭,但异常路径未关闭",
      "root_cause": "应该使用 finally 或 with 语句",
      "cwe_id": "CWE-755",
      "difficulty": "easy",
      "related_bugs": [
        "BUG_0009"
      ],
      "relative_path": "03_error_handling\\resource_cleanup\\positive\\example3_finally_missing.py"
    },
    {
      "id": "EXC-CLEAN-006",
      "category": "error_handling",
      "subcategory": "resource_cleanup",
      "severity": "medium",
      "type": "MissingFinally",
      "file": "example3_finally_missing.py",
      "function": "set_flag_and_process",
      "location": {
        "start_line": 50,
        "end_line": 50,
        "start_col": 4,
        "end_col": 41
      },
      "description": "标志在异常时未重置,导致后续调用被阻塞",
      "root_cause": "状态重置应该在 finally 块中",
      "cwe_id": "CWE-755",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0009"
      ],
      "relative_path": "03_error_handling\\resource_cleanup\\positive\\example3_finally_missing.py"
    },
    {
      "id": "CONC-ASYNC-001",
      "category": "concurrency",
      "subcategory": "async_await_misuse",
      "severity": "high",
      "type": "MissingAwait",
      "file": "example1_missing_await.py",
      "function": "process_items",
      "location": {
        "start_line": 47,
        "end_line": 47,
        "start_col": 14,
        "end_col": 66
      },
      "description": "异步函数调用缺少 await,返回 coroutine 对象而不是实际结果",
      "root_cause": "忘记在异步函数调用前添加 await 关键字",
      "cwe_id": "CWE-1088",
      "difficulty": "easy",
      "related_bugs": [
        "BUG_0004"
      ],
      "detection_layer": "Layer 1/2",
      "relative_path": "02_concurrency\\async_await_misuse\\positive\\example1_missing_await.py"
    },
    {
      "id": "CONC-ASYNC-002",
      "category": "concurrency",
      "subcategory": "async_await_misuse",
      "severity": "high",
      "type": "AwaitInSyncFunction",
      "file": "example1_missing_await.py",
      "function": "sync_function_with_await",
      "location": {
        "start_line": 183,
        "end_line": 183,
        "start_col": 4,
        "end_col": 37
      },
      "description": "在同步函数中使用 asyncio.run 创建新的 event loop，可能导致嵌套问题",
      "root_cause": "混淆异步和同步函数，在同步上下文中不当使用异步调用",
      "cwe_id": "CWE-662",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "02_concurrency\\async_await_misuse\\positive\\example1_missing_await.py"
    },
    {
      "id": "CONC-ASYNC-003",
      "category": "concurrency",
      "subcategory": "async_await_misuse",
      "severity": "high",
      "type": "BlockingCallInAsync",
      "file": "example1_missing_await.py",
      "function": "async_with_blocking_call",
      "location": {
        "start_line": 206,
        "end_line": 206,
        "start_col": 4,
        "end_col": 19
      },
      "description": "在异步函数中调用阻塞函数 time.sleep，阻塞整个事件循环",
      "root_cause": "使用同步阻塞调用而不是异步版本（asyncio.sleep）",
      "cwe_id": "CWE-662",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "02_concurrency\\async_await_misuse\\positive\\example1_missing_await.py"
    },
    {
      "id": "CONC-ASYNC-004",
      "category": "concurrency",
      "subcategory": "async_await_misuse",
      "severity": "critical",
      "type": "NestedEventLoop",
      "file": "example1_missing_await.py",
      "function": "nested_event_loop",
      "location": {
        "start_line": 232,
        "end_line": 232,
        "start_col": 8,
        "end_col": 43
      },
      "description": "在异步函数中使用 asyncio.run 创建嵌套 event loop，导致 RuntimeError",
      "root_cause": "在已有事件循环中尝试创建新的事件循环",
      "cwe_id": "CWE-662",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "02_concurrency\\async_await_misuse\\positive\\example1_missing_await.py"
    },
    {
      "id": "CONC-ASYNC-005",
      "category": "concurrency",
      "subcategory": "async_await_misuse",
      "severity": "medium",
      "type": "TaskNotAwaited",
      "file": "example1_missing_await.py",
      "function": "task_not_awaited",
      "location": {
        "start_line": 256,
        "end_line": 257,
        "start_col": 4,
        "end_col": 51
      },
      "description": "使用 asyncio.create_task 创建任务但未 await，可能导致资源泄露",
      "root_cause": "任务创建后未保存引用或等待完成",
      "cwe_id": "CWE-772",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "02_concurrency\\async_await_misuse\\positive\\example1_missing_await.py"
    },
    {
      "id": "CONC-DEAD-001",
      "category": "concurrency",
      "subcategory": "deadlock_risk",
      "severity": "critical",
      "type": "DeadlockRisk",
      "file": "example1_nested_locks.py",
      "function": "transfer_funds",
      "location": {
        "start_line": 46,
        "end_line": 46,
        "start_col": 4,
        "end_col": 25
      },
      "description": "嵌套锁顺序不一致,可能导致死锁",
      "root_cause": "两个线程以不同顺序获取相同的锁,形成循环等待",
      "cwe_id": "CWE-833",
      "difficulty": "high",
      "related_bugs": [
        "BUG_0003"
      ],
      "detection_layer": "Layer 3",
      "relative_path": "02_concurrency\\deadlock_risk\\positive\\example1_nested_locks.py"
    },
    {
      "id": "CONC-DEAD-002",
      "category": "concurrency",
      "subcategory": "deadlock_risk",
      "severity": "high",
      "type": "DeadlockRisk",
      "file": "example2_callback_wait_deadlock.py",
      "function": "trigger_event",
      "location": {
        "start_line": 20,
        "end_line": 20,
        "start_col": 8,
        "end_col": 23
      },
      "description": "持有锁时调用用户回调函数，回调可能尝试获取同一个锁导致死锁",
      "root_cause": "锁内调用不受控制的外部代码",
      "cwe_id": "CWE-833",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "02_concurrency\\deadlock_risk\\positive\\example2_callback_wait_deadlock.py"
    },
    {
      "id": "CONC-DEAD-003",
      "category": "concurrency",
      "subcategory": "deadlock_risk",
      "severity": "high",
      "type": "DeadlockRisk",
      "file": "example2_callback_wait_deadlock.py",
      "function": "process_data",
      "location": {
        "start_line": 32,
        "end_line": 32,
        "start_col": 12,
        "end_col": 37
      },
      "description": "持有锁时等待 Future.result()，异步任务如需同一锁则死锁",
      "root_cause": "锁内等待可能需要该锁的异步操作",
      "cwe_id": "CWE-833",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "02_concurrency\\deadlock_risk\\positive\\example2_callback_wait_deadlock.py"
    },
    {
      "id": "CONC-RACE-001",
      "category": "concurrency",
      "subcategory": "race_condition",
      "severity": "high",
      "type": "RaceCondition",
      "file": "example1_global_var.py",
      "function": "increment_counter",
      "location": {
        "start_line": 15,
        "end_line": 15,
        "start_col": 4,
        "end_col": 16
      },
      "description": "全局变量 counter 的读-修改-写操作在多线程环境未加锁",
      "root_cause": "全局变量写入未使用锁保护",
      "cwe_id": "CWE-362",
      "difficulty": "easy",
      "relative_path": "02_concurrency\\race_condition\\positive\\example1_global_var.py"
    },
    {
      "id": "CONC-RACE-002",
      "category": "concurrency",
      "subcategory": "race_condition",
      "severity": "high",
      "type": "RaceCondition",
      "file": "example1_global_var.py",
      "function": "update_cache",
      "location": {
        "start_line": 21,
        "end_line": 21,
        "start_col": 4,
        "end_col": 29
      },
      "description": "全局字典 cache_data 的修改未加锁",
      "root_cause": "字典操作在多线程环境未同步",
      "cwe_id": "CWE-362",
      "difficulty": "easy",
      "relative_path": "02_concurrency\\race_condition\\positive\\example1_global_var.py"
    },
    {
      "id": "CONC-RACE-003",
      "category": "concurrency",
      "subcategory": "race_condition",
      "severity": "high",
      "type": "RaceCondition",
      "file": "example1_global_var.py",
      "function": "get_and_increment",
      "location": {
        "start_line": 26,
        "end_line": 27,
        "start_col": 4,
        "end_col": 24
      },
      "description": "复合操作：读取和修改全局变量之间存在竞态窗口",
      "root_cause": "非原子复合操作",
      "cwe_id": "CWE-362",
      "difficulty": "medium",
      "relative_path": "02_concurrency\\race_condition\\positive\\example1_global_var.py"
    },
    {
      "id": "CONC-RACE-004",
      "category": "concurrency",
      "subcategory": "race_condition",
      "severity": "high",
      "type": "RaceCondition",
      "file": "example2_class_member.py",
      "function": "initialize_detector",
      "location": {
        "start_line": 26,
        "end_line": 26,
        "start_col": 4,
        "end_col": 50
      },
      "description": "全局对象成员 global_vars.detector 赋值存在竞态（BUG_0005 类型）",
      "root_cause": "类成员变量写入未同步",
      "cwe_id": "CWE-362",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0005"
      ],
      "relative_path": "02_concurrency\\race_condition\\positive\\example2_class_member.py"
    },
    {
      "id": "CONC-RACE-005",
      "category": "concurrency",
      "subcategory": "race_condition",
      "severity": "high",
      "type": "RaceCondition",
      "file": "example2_class_member.py",
      "function": "update_config",
      "location": {
        "start_line": 37,
        "end_line": 37,
        "start_col": 4,
        "end_col": 37
      },
      "description": "全局对象的字典成员修改未同步",
      "root_cause": "嵌套属性访问的字典操作未加锁",
      "cwe_id": "CWE-362",
      "difficulty": "medium",
      "relative_path": "02_concurrency\\race_condition\\positive\\example2_class_member.py"
    },
    {
      "id": "CONC-RACE-006",
      "category": "concurrency",
      "subcategory": "race_condition",
      "severity": "medium",
      "type": "RaceCondition",
      "file": "example2_class_member.py",
      "function": "handle_request",
      "location": {
        "start_line": 47,
        "end_line": 47,
        "start_col": 8,
        "end_col": 30
      },
      "description": "实例变量 request_count 在共享实例时存在竞态",
      "root_cause": "实例变量修改未考虑多线程共享场景",
      "cwe_id": "CWE-362",
      "difficulty": "medium",
      "relative_path": "02_concurrency\\race_condition\\positive\\example2_class_member.py"
    },
    {
      "id": "CONC-RACE-007",
      "category": "concurrency",
      "subcategory": "race_condition",
      "severity": "high",
      "type": "RaceCondition",
      "file": "example4_extended_races.py",
      "function": "__new__",
      "location": {
        "start_line": 10,
        "end_line": 10,
        "start_col": 8,
        "end_col": 33
      },
      "description": "单例模式双重检查锁定不正确，多线程下可能创建多个实例",
      "root_cause": "检查和实例化之间没有同步保护，存在竞态窗口",
      "cwe_id": "CWE-362",
      "difficulty": "high",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "02_concurrency\\race_condition\\positive\\example4_extended_races.py"
    },
    {
      "id": "CONC-RACE-008",
      "category": "concurrency",
      "subcategory": "race_condition",
      "severity": "medium",
      "type": "RaceCondition",
      "file": "example4_extended_races.py",
      "function": "get_resource",
      "location": {
        "start_line": 21,
        "end_line": 21,
        "start_col": 8,
        "end_col": 33
      },
      "description": "懒加载资源初始化无锁保护，多线程可能重复初始化",
      "root_cause": "检查和赋值操作非原子，缺少同步机制",
      "cwe_id": "CWE-362",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "02_concurrency\\race_condition\\positive\\example4_extended_races.py"
    },
    {
      "id": "CONC-RACE-009",
      "category": "concurrency",
      "subcategory": "race_condition",
      "severity": "medium",
      "type": "RaceCondition",
      "file": "example4_extended_races.py",
      "function": "increment_counter",
      "location": {
        "start_line": 29,
        "end_line": 29,
        "start_col": 4,
        "end_col": 23
      },
      "description": "全局计数器递增非原子操作，存在读-改-写竞态",
      "root_cause": "读取、修改、写入三步操作未加锁保护",
      "cwe_id": "CWE-362",
      "difficulty": "easy",
      "related_bugs": [],
      "detection_layer": "Layer 1",
      "relative_path": "02_concurrency\\race_condition\\positive\\example4_extended_races.py"
    },
    {
      "id": "RM-FILE-001",
      "category": "resource_management",
      "subcategory": "file_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example1_simple_leak.py",
      "function": "read_config",
      "location": {
        "start_line": 10,
        "end_line": 10,
        "start_col": 4,
        "end_col": 28
      },
      "description": "文件句柄未关闭，缺少 close() 调用",
      "root_cause": "open() 调用后未使用 with 语句或显式 close()",
      "cwe_id": "CWE-404",
      "difficulty": "easy",
      "relative_path": "01_resource_management\\file_leak\\positive\\example1_simple_leak.py"
    },
    {
      "id": "RM-FILE-002",
      "category": "resource_management",
      "subcategory": "file_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example1_simple_leak.py",
      "function": "write_log",
      "location": {
        "start_line": 16,
        "end_line": 16,
        "start_col": 4,
        "end_col": 28
      },
      "description": "日志文件句柄未关闭",
      "root_cause": "open() 调用后未使用 with 语句或显式 close()",
      "cwe_id": "CWE-404",
      "difficulty": "easy",
      "relative_path": "01_resource_management\\file_leak\\positive\\example1_simple_leak.py"
    },
    {
      "id": "RM-FILE-003",
      "category": "resource_management",
      "subcategory": "file_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example2_exception_path.py",
      "function": "process_data_file",
      "location": {
        "start_line": 10,
        "end_line": 10,
        "start_col": 4,
        "end_col": 30
      },
      "description": "异常路径下文件句柄未关闭",
      "root_cause": "try-except 块中异常发生时未释放资源",
      "cwe_id": "CWE-404",
      "difficulty": "medium",
      "relative_path": "01_resource_management\\file_leak\\positive\\example2_exception_path.py"
    },
    {
      "id": "RM-FILE-004",
      "category": "resource_management",
      "subcategory": "file_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example2_exception_path.py",
      "function": "load_config_with_fallback",
      "location": {
        "start_line": 27,
        "end_line": 27,
        "start_col": 4,
        "end_col": 34
      },
      "description": "多个 return 路径中某些路径文件未关闭",
      "root_cause": "提前 return 导致 close() 未执行",
      "cwe_id": "CWE-404",
      "difficulty": "medium",
      "relative_path": "01_resource_management\\file_leak\\positive\\example2_exception_path.py"
    },
    {
      "id": "RM-FILE-005",
      "category": "resource_management",
      "subcategory": "file_leak",
      "severity": "medium",
      "type": "ResourceImplicitCleanup",
      "file": "example3_direct_use.py",
      "function": "quick_write",
      "location": {
        "start_line": 10,
        "end_line": 10,
        "start_col": 4,
        "end_col": 45
      },
      "description": "文件对象直接使用未保存引用，依赖隐式清理（__del__）",
      "root_cause": "未保存文件句柄引用，依赖垃圾回收",
      "cwe_id": "CWE-404",
      "difficulty": "medium",
      "relative_path": "01_resource_management\\file_leak\\positive\\example3_direct_use.py"
    },
    {
      "id": "RM-FILE-006",
      "category": "resource_management",
      "subcategory": "file_leak",
      "severity": "medium",
      "type": "ResourceImplicitCleanup",
      "file": "example3_direct_use.py",
      "function": "chain_operations",
      "location": {
        "start_line": 16,
        "end_line": 16,
        "start_col": 14,
        "end_col": 48
      },
      "description": "链式调用中文件未保存引用",
      "root_cause": "未保存文件句柄引用，依赖垃圾回收",
      "cwe_id": "CWE-404",
      "difficulty": "medium",
      "relative_path": "01_resource_management\\file_leak\\positive\\example3_direct_use.py"
    },
    {
      "id": "RM-FILE-007",
      "category": "resource_management",
      "subcategory": "file_leak",
      "severity": "medium",
      "type": "ResourceImplicitCleanup",
      "file": "example3_direct_use.py",
      "function": "nested_open",
      "location": {
        "start_line": 22,
        "end_line": 22,
        "start_col": 19,
        "end_col": 48
      },
      "description": "嵌套调用中文件未保存引用",
      "root_cause": "未保存文件句柄引用，依赖垃圾回收",
      "cwe_id": "CWE-404",
      "difficulty": "medium",
      "relative_path": "01_resource_management\\file_leak\\positive\\example3_direct_use.py"
    },
    {
      "id": "RM-SYNC-001",
      "category": "resource_management",
      "subcategory": "lock_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example1_lock_leak.py",
      "function": "increment_counter_unsafe",
      "location": {
        "start_line": 26,
        "end_line": 26,
        "start_col": 4,
        "end_col": 27
      },
      "description": "Lock.acquire() 后未调用 release()，导致其他线程永久阻塞",
      "root_cause": "未使用 with 语句或 try/finally 释放锁",
      "cwe_id": "CWE-667",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "01_resource_management\\lock_leak\\positive\\example1_lock_leak.py"
    },
    {
      "id": "RM-SYNC-002",
      "category": "resource_management",
      "subcategory": "lock_leak",
      "severity": "medium",
      "type": "ResourceLeakRisk",
      "file": "example1_lock_leak.py",
      "function": "limited_resource_access_unsafe",
      "location": {
        "start_line": 90,
        "end_line": 90,
        "start_col": 4,
        "end_col": 23
      },
      "description": "Semaphore.acquire() 后未调用 release()，最终耗尽信号量资源",
      "root_cause": "未在 finally 块中释放信号量",
      "cwe_id": "CWE-667",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "01_resource_management\\lock_leak\\positive\\example1_lock_leak.py"
    },
    {
      "id": "RM-SYNC-003",
      "category": "resource_management",
      "subcategory": "lock_leak",
      "severity": "medium",
      "type": "ResourceLeakRisk",
      "file": "example1_lock_leak.py",
      "function": "producer_condition_leak",
      "location": {
        "start_line": 146,
        "end_line": 146,
        "start_col": 4,
        "end_col": 23
      },
      "description": "Condition.acquire() 后未调用 release()，内部锁未释放",
      "root_cause": "未使用 with 语句或 finally 块释放 condition",
      "cwe_id": "CWE-667",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "01_resource_management\\lock_leak\\positive\\example1_lock_leak.py"
    },
    {
      "id": "RM-NET-001",
      "category": "resource_management",
      "subcategory": "network_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example1_socket_leak.py",
      "function": "connect_to_server",
      "location": {
        "start_line": 24,
        "end_line": 24,
        "start_col": 4,
        "end_col": 56
      },
      "description": "Socket 连接后未关闭,导致文件描述符泄露",
      "root_cause": "未使用 with 语句或 finally 块关闭 socket",
      "cwe_id": "CWE-404",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0015"
      ],
      "detection_layer": "Layer 2",
      "relative_path": "01_resource_management\\network_leak\\positive\\example1_socket_leak.py"
    },
    {
      "id": "RM-NET-002",
      "category": "resource_management",
      "subcategory": "network_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example1_socket_leak.py",
      "function": "fetch_data",
      "location": {
        "start_line": 51,
        "end_line": 51,
        "start_col": 4,
        "end_col": 48
      },
      "description": "HTTP 连接未关闭,导致连接池耗尽",
      "root_cause": "HTTPConnection 对象未调用 close() 方法",
      "cwe_id": "CWE-404",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0015"
      ],
      "detection_layer": "Layer 2",
      "relative_path": "01_resource_management\\network_leak\\positive\\example1_socket_leak.py"
    },
    {
      "id": "RM-NET-003",
      "category": "resource_management",
      "subcategory": "network_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example2_database_leak.py",
      "function": "query_users_sqlite",
      "location": {
        "start_line": 18,
        "end_line": 18,
        "start_col": 4,
        "end_col": 42
      },
      "description": "SQLite 数据库连接创建后未关闭，导致文件描述符泄露和数据库锁无法释放",
      "root_cause": "未使用 with 语句或 finally 块关闭数据库连接",
      "cwe_id": "CWE-404",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "01_resource_management\\network_leak\\positive\\example2_database_leak.py"
    },
    {
      "id": "RM-NET-004",
      "category": "resource_management",
      "subcategory": "network_leak",
      "severity": "medium",
      "type": "ResourceLeakRisk",
      "file": "example3_smtp_leak.py",
      "function": "send_email_smtp",
      "location": {
        "start_line": 19,
        "end_line": 19,
        "start_col": 4,
        "end_col": 45
      },
      "description": "SMTP 连接创建后未调用 quit() 关闭，导致服务器端连接累积",
      "root_cause": "未使用 with 语句或 finally 块关闭 SMTP 连接",
      "cwe_id": "CWE-404",
      "difficulty": "medium",
      "related_bugs": [],
      "detection_layer": "Layer 2",
      "relative_path": "01_resource_management\\network_leak\\positive\\example3_smtp_leak.py"
    },
    {
      "id": "RM-POOL-001",
      "category": "resource_management",
      "subcategory": "thread_pool_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example1_no_shutdown.py",
      "function": "run_tasks_simple",
      "location": {
        "start_line": 12,
        "end_line": 12,
        "start_col": 4,
        "end_col": 48
      },
      "description": "ThreadPoolExecutor 创建后未调用 shutdown()",
      "root_cause": "未使用 with 语句或显式 shutdown()",
      "cwe_id": "CWE-404",
      "difficulty": "easy",
      "relative_path": "01_resource_management\\thread_pool_leak\\positive\\example1_no_shutdown.py"
    },
    {
      "id": "RM-POOL-002",
      "category": "resource_management",
      "subcategory": "thread_pool_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example1_no_shutdown.py",
      "function": "run_single_task",
      "location": {
        "start_line": 20,
        "end_line": 20,
        "start_col": 4,
        "end_col": 48
      },
      "description": "ThreadPoolExecutor 创建后未调用 shutdown()",
      "root_cause": "未使用 with 语句或显式 shutdown()",
      "cwe_id": "CWE-404",
      "difficulty": "easy",
      "relative_path": "01_resource_management\\thread_pool_leak\\positive\\example1_no_shutdown.py"
    },
    {
      "id": "RM-POOL-003",
      "category": "resource_management",
      "subcategory": "thread_pool_leak",
      "severity": "high",
      "type": "ResourceLeakRisk",
      "file": "example2_async_leak.py",
      "function": "run_in_thread_pool",
      "location": {
        "start_line": 17,
        "end_line": 17,
        "start_col": 4,
        "end_col": 52
      },
      "description": "异步函数中每次调用都创建新线程池但未关闭（BUG_0010 类型）",
      "root_cause": "函数每次调用创建新 Executor 但未释放",
      "cwe_id": "CWE-404",
      "difficulty": "medium",
      "related_bugs": [
        "BUG_0010"
      ],
      "relative_path": "01_resource_management\\thread_pool_leak\\positive\\example2_async_leak.py"
    }
  ]
}