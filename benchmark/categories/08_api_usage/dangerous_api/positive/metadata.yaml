# Dangerous API - Bug 标注

bugs:
  - id: "API-DANGER-001"
    category: "api_usage"
    subcategory: "dangerous_api"
    severity: "critical"
    type: "UnsafeDeserialization"
    file: "example1_pickle_yaml.py"
    function: "load_user_session"
    location:
      start_line: 23
      end_line: 23
      start_col: 4
      end_col: 43
    description: "pickle.loads() 反序列化不可信数据，可执行任意代码"
    root_cause: "pickle 反序列化可触发 __reduce__ 方法执行任意代码"
    cwe_id: "CWE-502"
    difficulty: "low"
    related_bugs: []
    detection_layer: "Layer 1"

  - id: "API-DANGER-002"
    category: "api_usage"
    subcategory: "dangerous_api"
    severity: "high"
    type: "UnsafeDeserialization"
    file: "example1_pickle_yaml.py"
    function: "load_config_yaml"
    location:
      start_line: 48
      end_line: 48
      start_col: 4
      end_col: 61
    description: "yaml.load() 使用 FullLoader 可执行 Python 代码"
    root_cause: "yaml.load 默认 Loader 不安全，应使用 safe_load"
    cwe_id: "CWE-502"
    difficulty: "low"
    related_bugs: []
    detection_layer: "Layer 1"
